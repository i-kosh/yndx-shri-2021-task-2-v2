!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var a=e();for(var s in a)("object"==typeof exports?exports:t)[s]=a[s]}}(this,(function(){return(()=>{"use strict";var t={d:(e,a)=>{for(var s in a)t.o(a,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:a[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{default:()=>n,prepareData:()=>n});function a(t,e){const a=Math.abs(t);return e[a%10==1&&a%100!=11?0:a%10>=2&&a%10<=4&&(a%100<10||a%100>=20)?1:2]}function s(t){return 0===t?"0":t>0?`+${t}`:`${t}`}function r(t,e,a,s){let r=0;Array.isArray(e.summaries)?e.summaries.forEach((t=>{const e=null==a?void 0:a.get(t);e&&(r=r+e.added+e.removed)})):r=e.summaries.added+e.summaries.removed;for(const e of t)if(r>=e.min&&r<=e.max){s?e.prevCommitsCount++:e.currentCommitsCount++;break}return t}function n(t=[],e={sprintId:0}){const{parsed:{comments:n,commits:i,sprints:o,summarys:u,users:m},currentSprint:c}=((t,e)=>{const a={commits:new Map,users:new Map,sprints:new Map,projects:new Map,issues:new Map,comments:new Map,summarys:new Map};let s;return t.forEach((t=>{switch(t.type){case"Commit":a.commits.set(t.id,t);break;case"Comment":a.comments.set(t.id,t);break;case"Issue":a.issues.set(t.id,t);break;case"Project":a.projects.set(t.id,t);break;case"Sprint":a.sprints.set(t.id,t),!s&&e&&t.id===e&&(s=t);break;case"User":a.users.set(t.id,t);break;case"Summary":a.summarys.set(t.id,t)}})),{parsed:a,currentSprint:s}})(t,e.sprintId),l=function(t,e,a){const s={alias:"leaders",data:{title:"Больше всего коммитов",subtitle:`${(null==t?void 0:t.name)||""}`,emoji:"👑",users:[]}},r=new Map;t&&e&&a&&e.forEach((e=>{if(e.timestamp>=t.startAt&&e.timestamp<=t.finishAt){const t="number"!=typeof e.author?e.author:a.get(e.author);if(!t)return void console.warn("автор не найден");const s=r.get(t);if(s)s.add(e);else{const a=new Set;r.set(t,a.add(e))}}}));for(const t of r){const e=t[0],a=t[1];s.data.users.push({id:e.id,name:e.name,avatar:e.avatar,valueText:`${a.size}`})}return s.data.users.sort(((t,e)=>{const a=parseInt(e.valueText)-parseInt(t.valueText);return 0===a?t.id-e.id:a})),s}(c,i,m);return[l,function(t,e,s){const r={alias:"vote",data:{title:"Самый 🔎 внимательный разработчик",emoji:"🔎",subtitle:(null==t?void 0:t.name)||"",users:[]}},n=new Map;t&&e&&s&&e.forEach((e=>{if(e.createdAt>=t.startAt&&e.createdAt<=t.finishAt){const t="number"!=typeof e.author?e.author:s.get(e.author);if(!t)return void console.warn("автор не найден");const a=n.get(t);n.set(t,(a||0)+e.likes.length)}}));for(const t of n){const e=t[0],s=t[1];r.data.users.push({id:e.id,name:e.name,avatar:e.avatar,valueText:`${s} ${a(s,["голос","голоса","голосов"])}`})}return r.data.users.sort(((t,e)=>parseInt(e.valueText)-parseInt(t.valueText))),r}(c,n,m),function(t,e,a,s){const r={alias:"chart",data:{subtitle:(null==t?void 0:t.name)||"",title:"Коммиты",users:e||[],values:[]}},n=new Map;t&&a&&s&&s.forEach((t=>{for(const e of a){const a=e[1];if(n.has(a)||n.set(a,0),t.timestamp>=a.startAt&&t.timestamp<=a.finishAt){const t=n.get(a)||0;n.set(a,t+1);break}}}));for(const e of n){const a=e[0],s=e[1],n={title:`${a.id}`,value:s,hint:a.name};(null==t?void 0:t.id)===a.id&&(n.active=!0),r.data.values.push(n)}return r.data.values.sort(((t,e)=>parseInt(t.title)-parseInt(e.title))),r}(c,l.data.users,o,i),function(t,e,n,i){const o=["коммит","коммита","коммитов"],u={alias:"diagram",data:{title:"Размер коммитов",subtitle:(null==t?void 0:t.name)||"",totalText:"",differenceText:"",categories:[]}};if(t&&e&&n){const m=e.get(t.id-1),c=[],l=[],d=[{title:"> 1001 строки",min:1001,max:1/0,currentCommitsCount:0,prevCommitsCount:0},{title:"501 — 1000 строк",min:501,max:1e3,currentCommitsCount:0,prevCommitsCount:0},{title:"101 — 500 строк",min:101,max:500,currentCommitsCount:0,prevCommitsCount:0},{title:"1 — 100 строк",min:1,max:100,currentCommitsCount:0,prevCommitsCount:0}];n.forEach((e=>{e.timestamp<=t.finishAt&&e.timestamp>=t.startAt&&(c.push(e),r(d,e,i)),m&&e.timestamp<=m.finishAt&&e.timestamp>=m.startAt&&(l.push(e),r(d,e,i,!0))})),u.data.totalText=`${c.length} ${a(c.length,o)}`;const f=c.length-l.length;u.data.differenceText=`${s(f)} с прошлого спринта`,d.forEach((t=>{const e=t.currentCommitsCount-t.prevCommitsCount;u.data.categories.push({title:t.title,valueText:`${t.currentCommitsCount} ${a(t.currentCommitsCount,o)}`,differenceText:`${s(e)} ${a(e,o)}`})}))}return u}(c,o,i,u),function(t,e){const a=["sun","mon","tue","wed","thu","fri","sat"],s={alias:"activity",data:{title:"Коммиты, 1 неделя",subtitle:(null==t?void 0:t.name)||"",data:{fri:new Array(24).fill(0),mon:new Array(24).fill(0),sat:new Array(24).fill(0),sun:new Array(24).fill(0),thu:new Array(24).fill(0),tue:new Array(24).fill(0),wed:new Array(24).fill(0)}}};return t&&e&&e.forEach((e=>{if(e.timestamp>=t.startAt&&e.timestamp<=t.finishAt){const t=new Date(e.timestamp),r=t.getHours(),n=t.getDay();s.data.data[a[n]][r]++}})),s}(c,i)]}return e})()}));